package com.dao.impl;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

import com.dao.HotelDao;
import com.pojo.Manager;
import com.pojo.Client;
import com.util.DBCon;

public class HotelDaoImpl implements HotelDao{

	//重写校验管理员登录
	@Override
	public Manager checkManagerLoginDao(String uname, String pwd) {
		Connection con = DBCon.getCon();
		PreparedStatement ps = null;
		ResultSet rs = null;
		String sql = "select * from manager where uname = ? and pwd = ?";
		Manager manager = null;
		try {
			ps = con.prepareStatement(sql);
			ps.setString(1, uname);
			ps.setString(2, pwd);
			rs = ps.executeQuery();
			while(rs.next()){
				manager = new Manager();
				manager.setUname(rs.getString("uname"));
				manager.setPwd(rs.getString("pwd"));
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		DBCon.Close(rs, ps, con);
		return manager;
	}

	//重写显示所有客户
	@Override
	public List<Client> clientShowDao() {
		System.out.println("dao");
		Connection con = DBCon.getCon();
		PreparedStatement ps = null;
		ResultSet rs = null;
		List<Client> clients = null;
		String sql = "select * from client";
		try {
			ps = con.prepareStatement(sql);
			rs = ps.executeQuery();
			clients = new ArrayList<Client>();
			while(rs.next()){
				Client client = new Client();
				client.setName(rs.getString("name"));
				client.setSex(rs.getString("sex"));
				client.setTel(rs.getString("tel"));
				clients.add(client);
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return clients;
	}
}
